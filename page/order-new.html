<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>个人报修</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" type="text/css" href="../css/icons-extra.css" />
		<link href="../css/css/mui.picker.css" rel="stylesheet" />
		<link href="../css/css/mui.poppicker.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/css/mui.picker.min.css" />
		<link rel="stylesheet" type="text/css" href="../upload/webuploader.css" />
		<style>
			html,
			body {
				background-color: #efeff4;
			}
			/*p {
				text-indent: 22px;
			}*/
			
			span.mui-icon {
				font-size: 20px;
				color: #fff;
			}
			
			.mui-off-canvas-left {
				color: #fff;
			}
			
			.title {
				margin: 35px 15px 10px;
			}
			
			.title+.content {
				margin: 10px 15px 35px;
				color: #bbb;
				text-indent: 1em;
				font-size: 14px;
				line-height: 24px;
			}
			
			input {
				color: #fff;
			}
			
			.userPic {
				position: absolute;
				top: 50%;
				left: 50%;
				-webkit-transform: translate(-50%, -50%);
				-ms-transform: translate(-50%, -50%);
				transform: translate(-50%, -50%);
			}
			
			.mui-repair {
				width: 44%;
				padding: 4% 0;
				margin: 0 0 0 4%;
				color: #fff;
				border: 0;
				background: #92b0dd;
				border-radius: 10px;
			}
			
			#offCanvasSideScroll {
				padding-top: 44px;
			}
			
			.mui-repair-left {
				margin-right: 4%;
				background: #e0b6b6;
			}
			
			.mui-repair-right {
				margin-left: -6px
			}
			
			.textA {
				vertical-align: middle
			}
			
			.f-white {
				color: #fff!important
			}
			
			.f-14 {
				font-size: 14px!important;
			}
			
			.bg-orange {
				background-color: #ff5700!important;
			}
			
			.userImg {
				position: absolute;
				top: 0;
				right: 40px;
				height: 43px;
				padding: 3px 0;
			}
			
			.mui-position-right {
				position: absolute;
				right: 40px;
			}
			
			.mui-bar {
				background-color: #ff5700
			}
			
			.f-orange {
				color: #ff5700!important
			}
			
			.f-blank {
				color: #000!important
			}
			
			.content {
				padding: 0 15px
			}
			
			.content .about {
				padding: 10px 0 10px;
			}
			/*控制退出的样式*/
			
			.exit .mui-table-view-cell {
				padding-right: 0
			}
			
			.exit .mui-table-view-cell>a:not(.mui-btn) {
				margin-right: 0
			}
			
			.orderNew {
				padding: 0 15px
			}
			
			.orderNew .mui-icon {
				font-size: 16PX;
			}
			
			.orderNew .mui-table-view-cell:after {
				left: 0
			}
			
			#submit {
				background: #ff5700;
				color: #fff;
				border-radius: 5px;
			}
			
			.mui-opacity {
				opacity: 0;
			}
			
			.mui-vertical {
				position: absolute;
				left: 50%;
				-webkit-transform: translate(-50%, 0);
				-ms-transform: translate(-50%, 0);
				transform: translate(-50%, 0);
			}
			
			.cross:after {
				position: absolute;
				content: '';
				width: 45px;
				height: 2px;
				background: #ccc;
				top: 50%;
				left: 50%;
				-webkit-transform: translate(-50%, -50%);
				-ms-transform: translate(-50%, -50%);
				transform: translate(-50%, -50%);
			}
			
			.cross:before {
				position: absolute;
				content: '';
				width: 2px;
				height: 45px;
				background: #ccc;
				top: 50%;
				left: 50%;
				-webkit-transform: translate(-50%, -50%);
				-ms-transform: translate(-50%, -50%);
				transform: translate(-50%, -50%);
			}
			
			.orderNew textarea {
				padding: 5px;
				margin-bottom: 0
			}
			
			#picture-list>.mui-btn:nth-child(4n+1) {
				margin: 0 -6px 1% 0;
			}
			
			#picture-list>.mui-btn {
				margin: 0 -6px 1%;
				margin-left: 1%
			}
			
			#picture-list>a>img {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 1;
			}
			
			.ui-alert {
				text-align: center;
				padding: 20px 10px;
				font-size: 16px;
			}
			
			.mui-table-view {
				margin-bottom: 10px
			}
		</style>
	</head>

	<body>
		<div class="orderNew">
			<header class="mui-bar mui-bar-nav transparent mui-box-shadow-none">
				<a href="index.html" class="mui-icon mui-icon-left-nav mui-pull-left f-white"></a>
				<h1 class="mui-title">个人报修</h1>
				<a href="message.html" class="mui-pull-right">
				</a>
			</header>
			<div id="offCanvasSideScroll" class="mui-scroll-wrapper mui-inner-wrap">
				<div class="mui-scroll">
					<div class="content">
						<form action="" method="post">
							<p class="about  mui-text-center">个人用户可在此报修，请填写需求内容<br />我们会尽快安排工作人员上门服务</p>
							<div class="mui-bar-nav">
								<ul class="mui-table-view">
									<li class="mui-table-view-cell">
										<a href="address.html" class="mui-navigate-right mui-icon mui-icon-location">
											报修地址
										</a>
									</li>
								</ul>
							</div>
							<div class="mui-bar-nav" id="orderList">
								<ul class="mui-table-view list-0">
									<li class="mui-table-view-cell">
										<a href="javascript:;" class="mui-navigate-right mui-icon mui-icon-location showCityPicker">
											报修类型
										</a>
									</li>
									<li class="mui-table-view-cell demo3">
										<a href="javascript:;" id="demo3" data-options='{"value":"2015-10-10 10:10","beginYear":2010,"endYear":2020}' class="mui-navigate-right mui-icon mui-icon-location">
											上门时间
										</a>
									</li>
									<li class="mui-table-view-cell">
										<div id="wrapper">
											<p class="order-title">你可以上传多张报修图片:</p>
											<div id="container">
												<!--头部，相册选择和格式选择-->
												<div id="uploader">
													<div class="queueList">
														<div id="dndArea" class="placeholder">
															<div id="filePicker"></div>
														</div>
													</div>
													<div class="statusBar" style="display:none;">
														<div class="btns">
															<div id="filePicker2"></div>
															<div class="uploadBtn">开始上传</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</li>
									<li class="mui-table-view-cell">
										<p class="order-title">请对报修项目进行描述:</p>
										<textarea name="" rows="5" cols="5"></textarea>
									</li>
								</ul>
							</div>
							<br />
							<div class="mui-bar-nav">
								<ul class="mui-table-view">
									<li class="mui-table-view-cell">
										<a href="javascript:;" class="mui-text-center add">
											+增加报修项目
										</a>
									</li>
								</ul>
							</div>
							<br />
							<div>
								<ul class="mui-table-view">
									<li class="mui-table-view-cell">
										<a href="javascript:;" id="submit" class="mui-text-center">
											确认下单
										</a>
									</li>
								</ul>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div id="picture" class="mui-popover mui-popover-action mui-popover-bottom">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<h4 class="mui-vertical">拍照或录像</h4>
					<input type="file" name="picture" id="camera" onchange="file(this)" class="mui-opacity" capture="camera" accept="image/*" />
				</li>
				<li class="mui-table-view-cell">
					<h4 class="mui-vertical">选取现有的</h4>
					<input type="file" name="picture" id="picture" onchange="file(this)" class="mui-opacity" accept="image/*" />
				</li>
			</ul>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#picture" class=""><b>取消</b></a>
				</li>
			</ul>
		</div>
		<script src="../js/mui.min.js"></script>
		<!--<script type="text/javascript" src="../js/js/vconsole.min.js"></script>-->
		<script src="../js/js/mui.picker.js"></script>
		<script src="../js/js/mui.poppicker.js"></script>
		<script src="../js/js/city.data.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/js/mui.picker.min.js"></script>
		<script src="../upload/jquery.js"></script>
		<script src="../upload/webuploader.js"></script>
		<script src="../upload/html2canvas.js"></script>
		<script src="../upload/upload.js"></script>
		<script>
			mui.init();
			var i = 0;
			mui.init({
				swipeBack: true //启用右滑关闭功能
			});
			//开启A标签的跳转
			mui('body').on('tap', 'a', function() {
				window.top.location.href = this.href;
			});
			//实现ios平台原生侧滑关闭页面；
			if(mui.os.plus && mui.os.ios) {
				mui.plusReady(function() {
					//5+ iOS暂时无法屏蔽popGesture时传递touch事件，故该demo直接屏蔽popGesture功能
					plus.webview.currentWebview().setStyle({
						'popGesture': 'none'
					});
				});
			}

			//初始化单页的区域滚动
			mui('.mui-scroll-wrapper').scroll();

			mui('body').on('shown', '.mui-popover', function(e) {
				//console.log('shown', e.detail.id);//detail为当前popover元素
			});
			mui('body').on('hidden', '.mui-popover', function(e) {
				//console.log('hidden', e.detail.id);//detail为当前popover元素
			});

			mui('body').on('tap', '.crossClick', function() {
				var a = this,
					parent;
				//根据点击按钮，反推当前是哪个actionsheet
				for(parent = a.parentNode; parent != document.body; parent = parent.parentNode) {
					if(parent.classList.contains('mui-popover-action')) {
						break;
					}
				}
				//关闭actionsheet
				mui('#' + parent.id).popover('toggle');
			})

			//控制上传图片的自适应宽度
			mui(function($) {
				var arr = document.querySelectorAll('.cross');
				for(var i = 0; i < arr.length; i++) {
					arr[i].style.padding = "12%";
				}

			});

			//			mui(function(e) {
			//				var picturChild = document.getElementById('picture-list').children.length;
			//				if(picturChild/4!=1){
			//					document.querySelectorAll('.crossClick')[0].style.margin='0 0 1% 1%';//控制添加按钮的样式的微调
			//				}
			//				
			//			})
			//增加项目类型
			mui('body').on('tap', '.add', function() {
				var table = document.body.querySelector('#orderList'),
					ul = document.createElement('ul');
				i++;
				ul.classList.add('mui-table-view');
				ul.classList.add('list-' + i);
				ul.innerHTML = ('<li class="mui-table-view-cell">' +
					'<a href="javascript:;" class="mui-navigate-right mui-icon mui-icon-location showCityPicker">' +
					'报修类型' +
					'</a>' +
					'</li>' +
					'<li class="mui-table-view-cell demo3">' +
					'<a href="javascript:;" data-options=' + {
						"value": "2015-10-10 10:10",
						"beginYear": 2010,
						"endYear": 2020
					} + ' class="mui-navigate-right mui-icon mui-icon-location">' +
					'上门时间' +
					'</a>' +
					'</li>' +
					'<li class="mui-table-view-cell">' +
					'<div id="wrapper">' +
					'<p class="order-title">你可以上传多张报修图片:</p>' +
					'<div id="container">' +
					'<div id="uploader">' +
					'<div class="queueList">' +
					'<div id="dndArea" class="placeholder">' +
					'<div id="filePicker"></div>' +
					'</div></div>' +
					'<div class="statusBar" style="display:none;">' +
					'<div class="btns">' +
					'<div id="filePicker2"></div>' +
					'<div class="uploadBtn">开始上传</div>' +
					'</div></div></div></div></div></li>' +
					'<li class="mui-table-view-cell">' +
					'<p class="order-title">请对报修项目进行描述:</p>' +
					'<textarea name="" rows="5" cols="5"></textarea>' +
					'</li>');
				table.appendChild(ul);
				// 实例化
				uploader = WebUploader.create({
					pick: {
						id: '#filePicker'+i,
						label: '点击选择图片'
					},
					formData: {
						attachmentFile: 111,
						attachmentType: 2
					},
					dnd: '#dndArea'+i,
					paste: '#uploader'+i,
					swf: '../../dist/Uploader.swf',
					chunked: false,
					compress: null,
					auto: false,
					fileNumLimit: 20,
					chunkSize: 512 * 1024,
					server: 'http://116.62.48.143/celefix/backend/base/saveImg',
					//server: 'http://127.0.0.1:8000/celefix/backend/base/saveAttachment',
					// runtimeOrder: 'flash',
					accept: {
						title: 'Images',
						extensions: 'gif,jpg,jpeg,bmp,png',
						mimeTypes: 'image/*'
					},
					// 禁掉全局的拖拽功能。这样不会出现图片拖进页面的时候，把图片打开。
					disableGlobalDnd: true,
					fileSizeLimit: 200 * 1024 * 1024, // 200 M
					fileSingleSizeLimit: 50 * 1024 * 1024 // 50 M
				});
			})
		</script>

		<script>
			(function($, doc) {
				$.init();
				$.ready(function() {
					//级联示例
					var cityPicker = new $.PopPicker({
						layer: 2
					});
					cityPicker.setData(cityData);
					mui('body').on('tap', '.showCityPicker', function(event) {
						cityPicker.show(function(items) {
							alert("你选择的项目是:" + items[0].text + " " + items[1].text);
							//返回 false 可以阻止选择框的关闭
							//return false;
						});
					}, false);
				});
			})(mui, document);
		</script>

		<script>
			(function($) {
				$.init();
				var btns = $('.demo3');
				btns.each(function(i, btn) {
					mui('body').on('tap', '.demo3', function() {
						var optionsJson = this.getAttribute('data-options') || '{}';
						var options = JSON.parse(optionsJson);
						var id = this.getAttribute('id');
						/*
						 * 首次显示时实例化组件
						 * 示例为了简洁，将 options 放在了按钮的 dom 上
						 * 也可以直接通过代码声明 optinos 用于实例化 DtPicker
						 */
						var picker = new $.DtPicker(options);
						picker.show(function(rs) {
							/*
							 * rs.value 拼合后的 value
							 * rs.text 拼合后的 text
							 * rs.y 年，可以通过 rs.y.vaue 和 rs.y.text 获取值和文本
							 * rs.m 月，用法同年
							 * rs.d 日，用法同年
							 * rs.h 时，用法同年
							 * rs.i 分（minutes 的第二个字母），用法同年
							 */
							alert('选择结果: ' + rs.y.text + rs.m.text + rs.d.text + rs.h.text);
							/* 
							 * 返回 false 可以阻止选择框的关闭
							 * return false;
							 */
							/*
							 * 释放组件资源，释放后将将不能再操作组件
							 * 通常情况下，不需要示放组件，new DtPicker(options) 后，可以一直使用。
							 * 当前示例，因为内容较多，如不进行资原释放，在某些设备上会较慢。
							 * 所以每次用完便立即调用 dispose 进行释放，下次用时再创建新实例。
							 */
							picker.dispose();
						});
					}, false);
				});
			})(mui);
		</script>
	</body>

</html>